[{"path":"https://selkamand.github.io/sigstats/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 sigstats authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://selkamand.github.io/sigstats/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Sam El-Kamand. Author, maintainer.","code":""},{"path":"https://selkamand.github.io/sigstats/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"El-Kamand S (2024). sigstats: Mathematical Operations Transformations Sigverse Signatures Catalogues. R package version 0.0.0.9000, https://selkamand.github.io/sigstats/, https://github.com/selkamand/sigstats.","code":"@Manual{,   title = {sigstats: Mathematical Operations and Transformations for Sigverse Signatures and Catalogues},   author = {Sam El-Kamand},   year = {2024},   note = {R package version 0.0.0.9000, https://selkamand.github.io/sigstats/},   url = {https://github.com/selkamand/sigstats}, }"},{"path":"https://selkamand.github.io/sigstats/index.html","id":"sigstats","dir":"","previous_headings":"","what":"Mathematical Operations and Transformations for Sigverse Signatures and Catalogues","title":"Mathematical Operations and Transformations for Sigverse Signatures and Catalogues","text":"sigstats enables common mathematical operations / transformations applied sigverse style signatures / catalogues","code":""},{"path":"https://selkamand.github.io/sigstats/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Mathematical Operations and Transformations for Sigverse Signatures and Catalogues","text":"can install development version sigstats like :","code":"if (!require(\"pak\", quietly = TRUE))     install.packages(\"pak\")  pak::pak(\"selkamand/sigstats\")"},{"path":"https://selkamand.github.io/sigstats/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Mathematical Operations and Transformations for Sigverse Signatures and Catalogues","text":"","code":"library(sigstats) library(sigstash) library(sigvis)  # Load a signature collection signatures <- sig_load(\"COSMIC_v3.3.1_SBS_GRCh38\")  # Create a model that represents a mix of SBS2 (40%) and SBS13 (60%) model <- c(SBS2 = 0.4, SBS13 = 0.6)  # Add selected signatures to the combined model combined_signatures <- sig_combine(signatures, model)  # Visualise result sig_visualise(   combined_signatures,    class = \"model\",   title = \"Model\",   subtitle = \"Created by combining SBS2 (40%) and SBS13 (60%)\"   ) #> ✔ All channels matched perfectly to set [sbs_96]. Using this set for sort order #> ✔ All types matched perfectly to set [sbs_type]. Using this set for sort order #> ✔ Types matched perfectly to palette [snv_type]"},{"path":"https://selkamand.github.io/sigstats/index.html","id":"reconstruct-a-mutation-catalogue-from-a-signature-model","dir":"","previous_headings":"Quick Start","what":"Reconstruct a mutation catalogue from a signature model","title":"Mathematical Operations and Transformations for Sigverse Signatures and Catalogues","text":"often need reconstruct catalogue (tally) signature model.","code":"# Load a signature collection signatures <- sig_load(\"COSMIC_v3.3.1_SBS_GRCh38\")  # Create a model that represents a mix of SBS2 (40%) and SBS13 (60%) model <- c(SBS2 = 0.4, SBS13 = 0.6)  # Create a new signature by combining SBS2 and SBS13 in ratios dictated by the above model signature <- sig_combine(signatures, model, format = \"signature\")  # Reconstruct a perfect catalogue describing what the mutational profile of a sample # with 200 mutations and the given signature model would look like reconstuction <- sig_reconstruct(signature, n=200)  # Visualise result sig_visualise(   reconstuction,    class = \"catalogue\",   title = \"Reconstructed Catalogue\",   subtitle = \"Expected profile of a sample with 200 mutations: 40% from SBS2, 60% from SBS13\"   ) #> ✔ All channels matched perfectly to set [sbs_96]. Using this set for sort order #> ✔ All types matched perfectly to set [sbs_type]. Using this set for sort order #> ✔ Types matched perfectly to palette [snv_type]"},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Signatures to a Combined Signature Model — sig_combine","title":"Add Signatures to a Combined Signature Model — sig_combine","text":"function takes signature collection model input adds selected signatures combined signature model. default output data.frame 'combined_signature_model' style data.frame format Sigverse package.","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Signatures to a Combined Signature Model — sig_combine","text":"","code":"sig_combine(signatures, model, format = c(\"combined\", \"signature\"))"},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Signatures to a Combined Signature Model — sig_combine","text":"signatures signature collection, typically list data.frames data.frame represents signature specific attributes. model named numeric vector representing contribution signature combined model. names correspond signatures, values represent contributions. sum values vector less equal 1. format character string indicating output format. \"combined\", function returns 'combined_signature_model' data.frame row represents contribution particular channel single signature (duplicate channels collapsed). \"signature\", function returns data sigverse signature format, representing novel signature created combining signatures collection according ratios described model.","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add Signatures to a Combined Signature Model — sig_combine","text":"data.frame 'combined_signature_model' style containing selected signatures modified fractions based model.","code":""},{"path":[]},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Signatures to a Combined Signature Model — sig_combine","text":"","code":"library(sigstash)  # Load a signature collection signatures <- sig_load(\"COSMIC_v3.3.1_SBS_GRCh38\")  # Create a model that represents a mix of SBS1 (40%) and SBS2 (60%) model <- c(SBS1 = 0.4, SBS2 = 0.6)  # Add selected signatures to the combined model combined_signatures <- sig_combine(signatures, model) print(combined_signatures) #> # A tibble: 192 × 5 #>    signature type  channel  fraction fraction_original #>    <chr>     <chr> <chr>       <dbl>             <dbl> #>  1 SBS1      C>A   A[C>A]A 0.000350           0.000876 #>  2 SBS1      C>A   A[C>A]C 0.000888           0.00222  #>  3 SBS1      C>A   A[C>A]G 0.0000719          0.000180 #>  4 SBS1      C>A   A[C>A]T 0.000506           0.00127  #>  5 SBS1      C>G   A[C>G]A 0.000736           0.00184  #>  6 SBS1      C>G   A[C>G]C 0.000475           0.00119  #>  7 SBS1      C>G   A[C>G]G 0.0000467          0.000117 #>  8 SBS1      C>G   A[C>G]T 0.000451           0.00113  #>  9 SBS1      C>T   A[C>T]A 0.00989            0.0247   #> 10 SBS1      C>T   A[C>T]C 0.00246            0.00615  #> # ℹ 182 more rows  # Visualise using sigvis"},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine_collapse_to_single_signature.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse to single signatures — sig_combine_collapse_to_single_signature","title":"Collapse to single signatures — sig_combine_collapse_to_single_signature","text":"Convert output sig_combine() simple sigverse signature object. useful want run maths signature derived model Note visualisation signature combination models, suggest directly using output sig_combine() sigvis::sig_visualise() sigvis::sig_make_interactive() run original signature contributions preserved","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine_collapse_to_single_signature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse to single signatures — sig_combine_collapse_to_single_signature","text":"","code":"sig_combine_collapse_to_single_signature(signature_combination)"},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine_collapse_to_single_signature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse to single signatures — sig_combine_collapse_to_single_signature","text":"signature_combination dataframe produced sig_combine() represents combination multiple signatures known (exact) proportions - individual signature kept distinct make easy plot stackedbar","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine_collapse_to_single_signature.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse to single signatures — sig_combine_collapse_to_single_signature","text":"data.frame sigverse signature format","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_combine_collapse_to_single_signature.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse to single signatures — sig_combine_collapse_to_single_signature","text":"","code":"library(sigstash)  # Load a signature collection signatures <- sig_load(\"COSMIC_v3.3.1_SBS_GRCh38\")  # Create a model that represents a mix of SBS1 (40%) and SBS2 (60%) model <- c(SBS1 = 0.4, SBS2 = 0.6)  # Add selected signatures to the combined model combined_signatures <- sig_combine(signatures, model)  # Flatten the combined_signatures dataframe that keeps separate signatures signature <- sig_combine_collapse_to_single_signature(combined_signatures)"},{"path":"https://selkamand.github.io/sigstats/reference/sig_compute_experimental_p_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Experimental P-Value Based on Bootstrap Contributions — sig_compute_experimental_p_value","title":"Calculate Experimental P-Value Based on Bootstrap Contributions — sig_compute_experimental_p_value","text":"single signature, calculate proportion bootstraps percentage contribution specified threshold. value represents 'experimental' P-value. example, P < 0.05, <5% chance signature contribution >= threshold chance.","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_compute_experimental_p_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Experimental P-Value Based on Bootstrap Contributions — sig_compute_experimental_p_value","text":"","code":"sig_compute_experimental_p_value(bootstraps, threshold)"},{"path":"https://selkamand.github.io/sigstats/reference/sig_compute_experimental_p_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Experimental P-Value Based on Bootstrap Contributions — sig_compute_experimental_p_value","text":"bootstraps numeric vector describing percentage contributions single signature different bootstraps. threshold numeric value specifying minimum contribution threshold (typically 0.05). referred sparsity threshold.","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_compute_experimental_p_value.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Experimental P-Value Based on Bootstrap Contributions — sig_compute_experimental_p_value","text":"proportion bootstraps contributions threshold. represents experimental p-value (referred sparsity p-value).","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_compute_experimental_p_value.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Experimental P-Value Based on Bootstrap Contributions — sig_compute_experimental_p_value","text":"","code":"bootstraps <- c(0.01, 0.03, 0.07, 0.02, 0.05) threshold <- 0.05 sig_compute_experimental_p_value(bootstraps, threshold) #> [1] 0.6"},{"path":"https://selkamand.github.io/sigstats/reference/sig_cosine_similarity.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Cosine Matrix Between Two Signatures — sig_cosine_similarity","title":"Calculate Cosine Matrix Between Two Signatures — sig_cosine_similarity","text":"Computes cosine similarity pair signatures sigverse signature collection","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_cosine_similarity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Cosine Matrix Between Two Signatures — sig_cosine_similarity","text":"","code":"sig_cosine_similarity(signature1, signature2, assume_sensible_input = FALSE)"},{"path":"https://selkamand.github.io/sigstats/reference/sig_cosine_similarity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Cosine Matrix Between Two Signatures — sig_cosine_similarity","text":"signature1, signature2 sigverse signature data.frames assume_sensible_input drastically speed similarity function, simply assume inputs valid signature objects, channels sorted. speed essential, perform checks upstream (flag)","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_cosine_similarity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Cosine Matrix Between Two Signatures — sig_cosine_similarity","text":"number 0 1 representing cosine similarity","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_cosine_similarity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Cosine Matrix Between Two Signatures — sig_cosine_similarity","text":"","code":"library(sigstash)  # Load a signature collection signatures <- sig_load(\"COSMIC_v3.3.1_SBS_GRCh38\")  # Compute cosine similarity between two signatures sig_cosine_similarity(signatures[[\"SBS1\"]], signatures[[\"SBS2\"]]) #> [1] 0.02031489"},{"path":"https://selkamand.github.io/sigstats/reference/sig_reconstruct.html","id":null,"dir":"Reference","previous_headings":"","what":"Reconstruct a catalogue from a signature — sig_reconstruct","title":"Reconstruct a catalogue from a signature — sig_reconstruct","text":"Generates reconstructed substitution profile (catalogues) generated proportionally combining estimated contribution.","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_reconstruct.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reconstruct a catalogue from a signature — sig_reconstruct","text":"","code":"sig_reconstruct(signature, n)"},{"path":"https://selkamand.github.io/sigstats/reference/sig_reconstruct.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reconstruct a catalogue from a signature — sig_reconstruct","text":"signature data.frame sigverse signature format n total number variants use reconstruction","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_reconstruct.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reconstruct a catalogue from a signature — sig_reconstruct","text":"data.frame conforming sigverse catalogue format","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_reconstruct.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reconstruct a catalogue from a signature — sig_reconstruct","text":"","code":"library(sigstash)  # Load a signature collection signatures <- sig_load(\"COSMIC_v3.3.1_SBS_GRCh38\")  # Create a model that represents a mix of SBS1 (40%) and SBS2 (60%) model <- c(SBS1 = 0.4, SBS2 = 0.6)  # Add selected signatures to the combined model combined_signatures <- sig_combine(signatures, model)  # Flatten the combined_signatures dataframe that keeps separate signatures signature <- sig_combine_collapse_to_single_signature(combined_signatures)  # Reconstruct a perfect catalogue describing what the mutational profile of a sample # with 200 mutations and the given signature model would look like reconstuction <- sig_reconstruct(signature, n=200)  # Visualise Result # sig_visualise(reconstuction, class = \"catalogue\")"},{"path":"https://selkamand.github.io/sigstats/reference/sig_subtract.html","id":null,"dir":"Reference","previous_headings":"","what":"Subtract Signature — sig_subtract","title":"Subtract Signature — sig_subtract","text":"Subtracts signature2 signature1 (factions) returns result. Works signatures. translate catalogue see sig_reconstruct()","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_subtract.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subtract Signature — sig_subtract","text":"","code":"sig_subtract(signature1, signature2)"},{"path":"https://selkamand.github.io/sigstats/reference/sig_subtract.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subtract Signature — sig_subtract","text":"signature1, signature2 sigverse signature data.frames","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_subtract.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subtract Signature — sig_subtract","text":"data.frame representing sigverse signature","code":""},{"path":"https://selkamand.github.io/sigstats/reference/sig_subtract.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subtract Signature — sig_subtract","text":"","code":"library(sigstash)  # Load a signature collection signatures <- sig_load(\"COSMIC_v3.3.1_SBS_GRCh38\")  # Subtract signatures sig_subtract(signatures[['SBS3']], signatures[['SBS4']]) #> # A tibble: 96 × 3 #>    type  channel fraction #>    <chr> <chr>      <dbl> #>  1 C>A   A[C>A]A -0.0215  #>  2 C>A   A[C>A]C -0.0166  #>  3 C>A   A[C>A]G -0.0143  #>  4 C>A   A[C>A]T -0.0174  #>  5 C>G   A[C>G]A  0.0129  #>  6 C>G   A[C>G]C  0.00878 #>  7 C>G   A[C>G]G -0.00106 #>  8 C>G   A[C>G]T  0.0139  #>  9 C>T   A[C>T]A  0.00553 #> 10 C>T   A[C>T]C  0.00814 #> # ℹ 86 more rows"}]
