% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/statistics.R
\name{sig_collection_pairwise_stats}
\alias{sig_collection_pairwise_stats}
\title{Compute Pairwise Similarity or Distance Metrics Between Signatures}
\usage{
sig_collection_pairwise_stats(
  signatures,
  metric = c("cosine_similarity", "L2", "L1"),
  format = c("data.frame", "matrix")
)
}
\arguments{
\item{signatures}{A signature collection, either as a named list of \code{sigverse} signature data.frames
or as a numeric matrix of fractional values (contexts × signatures). Column names are used as signature IDs.}

\item{metric}{Character; one of \code{c("cosine_similarity", "L2", "L1")}.
Determines which pairwise metric to compute.}

\item{format}{Character; one of \code{c("data.frame", "matrix")}.
\itemize{
\item \code{"data.frame"} (default): returns a long-format data.frame with columns \code{S1}, \code{S2}, and \verb{<metric>}.
\item \code{"matrix"}: returns an N×N symmetric numeric matrix of pairwise metrics (dimnames = signature IDs).
The diagonal is set to 1 for cosine similarity, and 0 for the distance metrics.
}}
}
\value{
Depending on \code{format}:
\describe{
\item{\code{data.frame}}{A data.frame with one row per unique signature pair, and columns
\code{S1}, \code{S2}, and the chosen metric (named after \code{metric}).}
\item{\code{matrix}}{A symmetric numeric matrix of pairwise metrics, with row and column names
corresponding to signature IDs.}
}
}
\description{
Calculates a specified pairwise metric for all unique pairs of signatures in a \code{sigverse} collection.
Supported metrics are:
\itemize{
\item \strong{\code{cosine_similarity}}: returns values in [0, 1], where 1 indicates identical signatures
\item \strong{\code{L2}}: Euclidean distance between signatures
\item \strong{\code{L1}}: Manhattan distance between signatures
}
}
\details{
The input may be supplied either as:
\itemize{
\item A \strong{named list} of \code{sigverse} signature data.frames (each validated via
\code{\link[sigshared:signature_collection]{sigshared::assert_signature_collection()}}), or
\item A \strong{numeric matrix} (rows = mutation contexts, columns = signatures) with non-NULL, unique column names.
}

Before computing any metric, each column is normalized to sum to 1 (via
\code{sigshared::compute_fraction()}), ensuring minor rounding errors in provided fractions do not affect results.
}
\examples{
library(sigstash)
signatures <- sig_load("COSMIC_v3.3.1_SBS_GRCh38")

# Long-format cosine similarities
sig_collection_pairwise_stats(signatures,
                              metric = "cosine_similarity",
                              format = "data.frame")

# Symmetric matrix of Euclidean distances
sig_collection_pairwise_stats(signatures,
                              metric = "L2",
                              format = "matrix")

}
\seealso{
\code{\link[=sig_cosine_similarity]{sig_cosine_similarity()}}, \code{\link[=sig_l2_distance]{sig_l2_distance()}}, \code{\link[=sig_lp_distance]{sig_lp_distance()}}, \code{\link[=sig_collection_stats]{sig_collection_stats()}}
}
