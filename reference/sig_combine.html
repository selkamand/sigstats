<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add Signatures to a Combined Signature Model — sig_combine • sigstats</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add Signatures to a Combined Signature Model — sig_combine"><meta name="description" content="This function takes a signature collection and a model as input and adds selected signatures to a combined signature model. The default output is a data.frame in the 'combined_signature_model' style data.frame format from the Sigverse package."><meta property="og:description" content="This function takes a signature collection and a model as input and adds selected signatures to a combined signature model. The default output is a data.frame in the 'combined_signature_model' style data.frame format from the Sigverse package."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sigstats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/selkamand/sigstats/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add Signatures to a Combined Signature Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/selkamand/sigstats/blob/master/R/sig_maths.R" class="external-link"><code>R/sig_maths.R</code></a></small>
      <div class="d-none name"><code>sig_combine.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a signature collection and a model as input and adds selected signatures to a combined signature model. The default output is a data.frame in the 'combined_signature_model' style data.frame format from the Sigverse package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sig_combine</span><span class="op">(</span></span>
<span>  <span class="va">signatures</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"signature"</span>, <span class="st">"combined"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-signatures">signatures<a class="anchor" aria-label="anchor" href="#arg-signatures"></a></dt>
<dd><p>A sigverse signature collection. See (<code><a href="https://rdrr.io/pkg/sigshared/man/signature_collection.html" class="external-link">sigshared::example_signature_collection()</a></code>) for details.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A named numeric vector representing the contribution of each signature to the combined model.
The names correspond to the signatures, and the values represent their contributions.
The sum of the values in this vector should be less than or equal to 1.</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>A character string indicating the output format.
If "combined", the function returns a 'combined_signature_model' data.frame where each row represents a contribution for a particular channel from a single signature (duplicate channels are not collapsed).
If "signature", the function returns the data in the sigverse signature format, representing a novel signature created by combining the signatures in the collection according to the ratios described by the model.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>enables detailed output messages (flag).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame in the 'combined_signature_model' style containing the selected signatures and their modified fractions based on the model.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>example_signature_collection</code> <code>example_model</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sigstash</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load a signature collection</span></span></span>
<span class="r-in"><span><span class="va">signatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sigstash/man/sig_load.html" class="external-link">sig_load</a></span><span class="op">(</span><span class="st">"COSMIC_v3.3.1_SBS_GRCh38"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a model that represents a mix of SBS1 (40%) and SBS2 (60%)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>SBS1 <span class="op">=</span> <span class="fl">0.4</span>, SBS2 <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add selected signatures to the combined model</span></span></span>
<span class="r-in"><span><span class="va">combined_signatures</span> <span class="op">&lt;-</span> <span class="fu">sig_combine</span><span class="op">(</span><span class="va">signatures</span>, <span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_signatures</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    type channel     fraction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   C&gt;A A[C&gt;A]A 3.507565e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   C&gt;A A[C&gt;A]C 9.753506e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   C&gt;A A[C&gt;A]G 1.040620e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   C&gt;A A[C&gt;A]T 5.645758e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   C&gt;G A[C&gt;G]A 7.356219e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   C&gt;G A[C&gt;G]C 5.536380e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   C&gt;G A[C&gt;G]G 5.605870e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   C&gt;G A[C&gt;G]T 5.052782e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   C&gt;T A[C&gt;T]A 9.923988e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  C&gt;T A[C&gt;T]C 3.275645e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  C&gt;T A[C&gt;T]G 1.482697e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  C&gt;T A[C&gt;T]T 4.900869e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  T&gt;A A[T&gt;A]A 3.704447e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  T&gt;A A[T&gt;A]C 1.405570e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  T&gt;A A[T&gt;A]G 4.620521e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  T&gt;A A[T&gt;A]T 7.178224e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  T&gt;C A[T&gt;C]A 4.637984e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  T&gt;C A[T&gt;C]C 1.213215e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  T&gt;C A[T&gt;C]G 4.939210e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  T&gt;C A[T&gt;C]T 2.343610e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  T&gt;G A[T&gt;G]A 2.086691e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  T&gt;G A[T&gt;G]C 1.263457e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  T&gt;G A[T&gt;G]G 1.062807e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  T&gt;G A[T&gt;G]T 4.616597e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  C&gt;A C[C&gt;A]A 2.451991e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  C&gt;A C[C&gt;A]C 7.513668e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  C&gt;A C[C&gt;A]G 3.678179e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  C&gt;A C[C&gt;A]T 2.493459e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  C&gt;G C[C&gt;G]A 9.424529e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  C&gt;G C[C&gt;G]C 2.363192e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  C&gt;G C[C&gt;G]G 1.680262e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  C&gt;G C[C&gt;G]T 3.766841e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  C&gt;T C[C&gt;T]A 3.340651e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  C&gt;T C[C&gt;T]C 2.048862e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  C&gt;T C[C&gt;T]G 7.900789e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  C&gt;T C[C&gt;T]T 9.354423e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  T&gt;A C[T&gt;A]A 1.615965e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  T&gt;A C[T&gt;A]C 3.007052e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  T&gt;A C[T&gt;A]G 2.161075e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  T&gt;A C[T&gt;A]T 1.028904e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  T&gt;C C[T&gt;C]A 1.798213e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  T&gt;C C[T&gt;C]C 1.002896e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  T&gt;C C[T&gt;C]G 1.415402e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  T&gt;C C[T&gt;C]T 1.283336e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  T&gt;G C[T&gt;G]A 1.050587e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  T&gt;G C[T&gt;G]C 1.761738e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  T&gt;G C[T&gt;G]G 1.223743e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  T&gt;G C[T&gt;G]T 1.893343e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  C&gt;A G[C&gt;A]A 6.739429e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  C&gt;A G[C&gt;A]C 1.317277e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51  C&gt;A G[C&gt;A]G 2.414671e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  C&gt;A G[C&gt;A]T 3.039667e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  C&gt;G G[C&gt;G]A 4.280223e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54  C&gt;G G[C&gt;G]C 2.173235e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55  C&gt;G G[C&gt;G]G 6.592130e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56  C&gt;G G[C&gt;G]T 7.955379e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57  C&gt;T G[C&gt;T]A 1.749326e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58  C&gt;T G[C&gt;T]C 3.613588e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59  C&gt;T G[C&gt;T]G 8.657135e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60  C&gt;T G[C&gt;T]T 4.497471e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  T&gt;A G[T&gt;A]A 3.173979e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  T&gt;A G[T&gt;A]C 1.282647e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  T&gt;A G[T&gt;A]G 1.353408e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  T&gt;A G[T&gt;A]T 1.408428e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  T&gt;C G[T&gt;C]A 4.104283e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  T&gt;C G[T&gt;C]C 7.606214e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67  T&gt;C G[T&gt;C]G 5.261763e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68  T&gt;C G[T&gt;C]T 3.598995e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69  T&gt;G G[T&gt;G]A 1.237254e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70  T&gt;G G[T&gt;G]C 7.891291e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71  T&gt;G G[T&gt;G]G 1.596591e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72  T&gt;G G[T&gt;G]T 5.823419e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73  C&gt;A T[C&gt;A]A 4.088038e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74  C&gt;A T[C&gt;A]C 1.100521e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75  C&gt;A T[C&gt;A]G 5.188617e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76  C&gt;A T[C&gt;A]T 2.670355e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77  C&gt;G T[C&gt;G]A 2.217865e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78  C&gt;G T[C&gt;G]C 1.391628e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79  C&gt;G T[C&gt;G]G 5.293497e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  C&gt;G T[C&gt;G]T 1.329548e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81  C&gt;T T[C&gt;T]A 3.215172e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82  C&gt;T T[C&gt;T]C 5.819379e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83  C&gt;T T[C&gt;T]G 7.106643e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84  C&gt;T T[C&gt;T]T 1.804772e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85  T&gt;A T[T&gt;A]A 2.858385e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86  T&gt;A T[T&gt;A]C 1.165516e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87  T&gt;A T[T&gt;A]G 4.116638e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88  T&gt;A T[T&gt;A]T 1.010989e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89  T&gt;C T[T&gt;C]A 9.904566e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90  T&gt;C T[T&gt;C]C 1.385195e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91  T&gt;C T[T&gt;C]G 2.350857e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92  T&gt;C T[T&gt;C]T 1.731088e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93  T&gt;G T[T&gt;G]A 9.823727e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94  T&gt;G T[T&gt;G]C 6.482091e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95  T&gt;G T[T&gt;G]G 2.883043e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96  T&gt;G T[T&gt;G]T 2.214016e-16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualise using sigvis</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sam El-Kamand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

