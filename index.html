<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sigstats provides tools for performing common mathematical operations and transformations on sigverse style signatures and catalogues. This package enables users to create models of mutational signatures, combine them, and reconstruct mutation catalogues. Visualization functions are also included for easy interpretation of the results. `The package is designed to work seamlessly with other sigverse packages like sigstash and sigvis.">
<title>Mathematical Operations and Transformations for Sigverse Signatures and Catalogues • sigstats</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Mathematical Operations and Transformations for Sigverse Signatures and Catalogues">
<meta property="og:description" content="sigstats provides tools for performing common mathematical operations and transformations on sigverse style signatures and catalogues. This package enables users to create models of mutational signatures, combine them, and reconstruct mutation catalogues. Visualization functions are also included for easy interpretation of the results. `The package is designed to work seamlessly with other sigverse packages like sigstash and sigvis.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">sigstats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/selkamand/sigstats/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sigstats">sigstats<a class="anchor" aria-label="anchor" href="#sigstats"></a>
</h1></div>
<!-- badges: start -->

<p><strong>sigstats</strong> enables common mathematical operations / transformations to be applied to <strong>sigverse</strong> style signatures / catalogues</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of sigstats like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://pak.r-lib.org/" class="external-link">"pak"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"selkamand/sigstats"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/selkamand/sigstats" class="external-link">sigstats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sigstash</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sigvis</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load a signature collection</span></span>
<span><span class="va">signatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sigstash/man/sig_load.html" class="external-link">sig_load</a></span><span class="op">(</span><span class="st">"COSMIC_v3.3.1_SBS_GRCh38"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a model that represents a mix of SBS2 (40%) and SBS13 (60%)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>SBS2 <span class="op">=</span> <span class="fl">0.4</span>, SBS13 <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add selected signatures to the combined model</span></span>
<span><span class="va">combined_signatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sig_combine.html">sig_combine</a></span><span class="op">(</span><span class="va">signatures</span>, <span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise result</span></span>
<span><span class="fu">sig_visualise</span><span class="op">(</span></span>
<span>  <span class="va">combined_signatures</span>, </span>
<span>  class <span class="op">=</span> <span class="st">"model"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Model"</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="st">"Created by combining SBS2 (40%) and SBS13 (60%)"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All channels matched perfectly to set [sbs_96]. Using this set for sort order</span></span>
<span><span class="co">#&gt; ✔ All types matched perfectly to set [sbs_type]. Using this set for sort order</span></span>
<span><span class="co">#&gt; ✔ Types matched perfectly to palette [snv_type]</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<div class="section level3">
<h3 id="reconstruct-a-mutation-catalogue-from-a-signature-model">Reconstruct a mutation catalogue from a signature model<a class="anchor" aria-label="anchor" href="#reconstruct-a-mutation-catalogue-from-a-signature-model"></a>
</h3>
<p>We often need to reconstruct a catalogue (or tally) from our signature model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a signature collection</span></span>
<span><span class="va">signatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sigstash/man/sig_load.html" class="external-link">sig_load</a></span><span class="op">(</span><span class="st">"COSMIC_v3.3.1_SBS_GRCh38"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a model that represents a mix of SBS2 (40%) and SBS13 (60%)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>SBS2 <span class="op">=</span> <span class="fl">0.4</span>, SBS13 <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new signature by combining SBS2 and SBS13 in ratios dictated by the above model</span></span>
<span><span class="va">signature</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sig_combine.html">sig_combine</a></span><span class="op">(</span><span class="va">signatures</span>, <span class="va">model</span>, format <span class="op">=</span> <span class="st">"signature"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reconstruct a perfect catalogue describing what the mutational profile of a sample</span></span>
<span><span class="co"># with 200 mutations and the given signature model would look like</span></span>
<span><span class="va">reconstuction</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sig_reconstruct.html">sig_reconstruct</a></span><span class="op">(</span><span class="va">signature</span>, n<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise result</span></span>
<span><span class="fu">sig_visualise</span><span class="op">(</span></span>
<span>  <span class="va">reconstuction</span>, </span>
<span>  class <span class="op">=</span> <span class="st">"catalogue"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Reconstructed Catalogue"</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="st">"Expected profile of a sample with 200 mutations: 40% from SBS2, 60% from SBS13"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All channels matched perfectly to set [sbs_96]. Using this set for sort order</span></span>
<span><span class="co">#&gt; ✔ All types matched perfectly to set [sbs_type]. Using this set for sort order</span></span>
<span><span class="co">#&gt; ✔ Types matched perfectly to palette [snv_type]</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/selkamand/sigstats/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/selkamand/sigstats/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sigstats</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sam El-Kamand <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2270-8088" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=sigstats" class="external-link"><img src="https://www.r-pkg.org/badges/version/sigstats" alt="CRAN status"></a></li>
<li><a href="https://github.com/selkamand/sigstats/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/selkamand/sigstats/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sam El-Kamand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
